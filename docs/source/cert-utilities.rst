
.. _cert-utilities:

Набор утилит для автоматизации работы
=================================================

В данном разделе приводится ряд утилит под общим названием ``cert-utulities`` для автоматизации работы с сертификатами и контейнерами.

Большинство утилит написаны на языке программирования Python 3.x и требует наличия в системе установленного интерпритатора Python (`Скачать <https://goo.gl/czYuW1>`_).

Утилита cert-info
------------------------------

.. ``cert-info.py`` -- утилита для просмотра информации о сертификатах. Выводит в файл следующую информацию о сертификатах, находящихся в текущей директории:

*В разработке..*



Массовая установка сертификатов
------------------------------------

Скрипт ``cer-install.py`` массово устанавливает сертификаты открытых ключей, которые имеются на данный момент в системе. Поэтому перед установкой необходимо отключать все лишние носители.

Для запуска сскрипта требуется:

1. Установить интерпритатор языка программирования Python, если он еще не установлен;
2. Скопировать скрипт в любое место и запустить двойным нажатием.

После завершения работы скрипта появится сообщение ``Нажмите Enter``. Перед нажатием на ``Enter`` можно ознакомиться с выведенной информацией.

Пример вывода результатов работы скрипта выглядит так:

::

    Текущая директория: C:\Program Files\Crypto Pro\CSP
    Выполняемая команда: csptest.exe -keyset -enum_cont -verifycontext -fqcn

    Список контейнеров, для которых будут установлены сертификаты (имя/носитель):
    - 2015ZAO_ (REGISTRY)
    - 2015ZAO_4 (FAT12_H)
    - 2015ZAO_flash (FAT12_H)
    - 2015ZAO_2 (FAT12_H)
    - 2015ZAO_3 (FAT12_H)
    ======================================================================
    Exchange key found.

    Show user cert property
    Property # 2 found->KEY PROV INFO PROP ID.
    The current key container is: REGISTRY\\2015ZAO_
    The provider name is: Crypto-Pro GOST R 34.10-2001 Cryptographic Service Provider
    Exchange key installed successfully.
    No signature key found.
    Total: SYS: 0,359 sec USR: 0,203 sec UTC: 0,609 sec
    [ErrorCode: 0x00000000]
    ======================================================================
    ...
    ======================================================================
    Exchange key found.

    Show user cert property
    Property # 2 found->KEY PROV INFO PROP ID.
    The current key container is: FAT12\C8418588\2015ZAOr.002\E4DD
    The provider name is: Crypto-Pro GOST R 34.10-2001 Cryptographic Service Provider
    Exchange key installed successfully.
    No signature key found.
    Total: SYS: 0,406 sec USR: 0,234 sec UTC: 0,656 sec
    [ErrorCode: 0x00000000]
    ======================================================================

    Нажмите Enter

Фраза ``Exchange key installed successfully.`` говорит о том, что сертификат данного контейнера установлен успешно.

.. tip:: При работе с большим количеством сертификатов, удобнее перенаправить вывод результатов в файл, подробнее смотрите в разделе :ref:`FileOut`.


.. warning:: Скрипт ``cer-install.py`` просто устанавливает сертификаты открытых ключей всех контенейров, найденных в системе. Поэтому если имеется копия контейнера, то сертификат будет ссылаться на тот контейнер, который был обработан последним.

 Обычно сначала обрабатываются контейнеры, хранящиеся в реестре, затем на Рутокене, потом на флешке или дискете.


Массовое копирование контейнеров
----------------------------------------------

*В разработке..*

